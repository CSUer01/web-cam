<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è¿œç¨‹ç›‘æ§æ§åˆ¶å° - ç”»é¢ä¿®å¤ç‰ˆ</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #000; color: #00ff00; font-family: monospace; text-align: center; margin: 0; padding: 20px; }
        #video-container { 
            width: 90%; max-width: 800px; margin: auto; border: 1px solid #333; 
            background: #111; min-height: 400px; display: flex; align-items: center; justify-content: center;
        }
        video { width: 100%; height: auto; display: block; }
        .controls { margin: 20px; }
        button { background: #00ff00; color: #000; padding: 15px 30px; border: none; font-weight: bold; cursor: pointer; }
        #status { color: #ffcc00; margin: 10px; }
    </style>
</head>
<body>
    <h2>LIVE STREAM</h2>
    <div id="status">ç³»ç»Ÿå‡†å¤‡å°±ç»ª</div>

    <div id="video-container" onclick="manualPlay()">
        <video id="remoteVideo" autoplay playsinline muted></video>
        <div id="placeholder" style="position: absolute;">ç­‰å¾…ç”»é¢ä¼ è¾“...<br>(è‹¥æ¡æ‰‹æˆåŠŸåä»é»‘å±ï¼Œè¯·ç‚¹å‡»æ­¤å¤„)</div>
    </div>

    <div class="controls">
        <button onclick="startCall()">ğŸ“¡ å¼€å¯è¿œç¨‹ç›‘æ§</button>
    </div>

    <script>
        const targetID = 'my_secret_cam_9988'; // è¯·ç¡®è®¤ä¸æ‰‹æœºç«¯ä¸€è‡´
        const peer = new Peer();
        const video = document.getElementById('remoteVideo');

        function startCall() {
            document.getElementById('status').innerText = "æ­£åœ¨å°è¯•è¿æ¥æ‰‹æœº...";
            
            // éšä¾¿å¼„ä¸ªç©ºæµå»éª—è¿‡ WebRTC æ¡æ‰‹åè®®
            const canvas = document.createElement('canvas');
            const stream = canvas.captureStream();

            const call = peer.call(targetID, stream);
            
            call.on('stream', (remoteStream) => {
                document.getElementById('status').innerText = "ğŸŸ¢ å·²æ¥æ”¶åˆ°ä¿¡å·ï¼Œæ­£åœ¨è§£ç ...";
                document.getElementById('placeholder').style.display = 'none';
                
                video.srcObject = remoteStream;
                
                // æ ¸å¿ƒä¿®å¤ï¼šåå¤å°è¯•æ’­æ”¾ï¼Œç›´åˆ°ç”»é¢å‡ºæ¥
                const playPromise = video.play();
                if (playPromise !== undefined) {
                    playPromise.catch(() => {
                        document.getElementById('status').innerText = "ğŸŸ¡ æµè§ˆå™¨æ‹¦æˆªäº†è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹é»‘è‰²åŒºåŸŸ";
                    });
                }
            });
        }

        function manualPlay() {
            video.play();
            document.getElementById('status').innerText = "ğŸŸ¢ å·²æ‰‹åŠ¨æ¿€æ´»ç”»é¢";
        }

        peer.on('error', (err) => {
            document.getElementById('status').innerText = "ğŸ”´ è¿æ¥å¤±è´¥: " + err.type;
        });
    </script>
</body>
</html>
