<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¿œç¨‹ç›‘æ§æ§åˆ¶å° - æœ€ç»ˆç‰ˆ</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #000; color: #00ff00; font-family: 'Courier New', monospace; text-align: center; padding: 20px; margin: 0; }
        .monitor-box { 
            width: 90%; max-width: 800px; margin: 20px auto; 
            border: 2px solid #333; background: #0a0a0a;
            position: relative; cursor: pointer;
        }
        /* å¼ºåˆ¶è§†é¢‘æ‹‰ä¼¸å¡«æ»¡ */
        video { width: 100%; height: auto; display: block; min-height: 300px; }
        .controls { margin-top: 20px; background: #111; padding: 20px; border-radius: 10px; }
        #status-bar { font-size: 1.2rem; color: #ffcc00; margin-bottom: 10px; }
        button { 
            background: #00ff00; color: #000; border: none; padding: 15px 40px; 
            font-size: 1.2rem; font-weight: bold; cursor: pointer; border-radius: 5px;
        }
        .tip { font-size: 0.8rem; color: #555; margin-top: 10px; }
        .log { 
            margin-top: 20px; font-size: 0.8rem; color: #444; text-align: left; 
            max-width: 800px; margin: 20px auto; padding: 10px; border-top: 1px solid #222;
        }
    </style>
</head>
<body>

    <h1 style="letter-spacing: 3px;">LIVE FEED MONITOR</h1>
    
    <div id="status-bar">ç³»ç»Ÿå¾…å‘½</div>

    <div class="monitor-box" onclick="forcePlay()">
        <video id="remoteVideo" autoplay playsinline muted></video>
        <p id="click-tip" style="position:absolute; top:45%; width:100%; color:#555; display:none;">è‹¥é»‘å±ï¼Œè¯·ç‚¹å‡»æ­¤å¤„æ¿€æ´»ç”»é¢</p>
    </div>

    <div class="controls">
        <button onclick="connectToPhone()">ğŸ“¡ å¼€å§‹æ¥æ”¶ç›‘æ§ç”»é¢</button>
        <p class="tip">æç¤ºï¼šå¿…é¡»å…ˆåœ¨æ‰‹æœºç«¯ç‚¹å‡»â€œåŒæ­¥æ—¶é—´â€å¹¶æ˜¾ç¤º ONLINE</p>
    </div>

    <div class="log" id="logBox">ç»ˆç«¯æ—¥å¿—:</div>

    <script>
        // --- ç¡®ä¿ä¸æ‰‹æœºç«¯ myID ä¿æŒä¸€è‡´ ---
        const targetPhoneId = 'my_secret_cam_9988'; 

        const logBox = document.getElementById('logBox');
        const statusBar = document.getElementById('status-bar');
        const video = document.getElementById('remoteVideo');
        const peer = new Peer();

        peer.on('open', (id) => {
            statusBar.innerText = "æœ¬æœºå°±ç»ª ID: " + id;
            addLog("è¿æ¥ä¿¡ä»¤æœåŠ¡å™¨æˆåŠŸ");
        });

        // æ ¸å¿ƒè¿æ¥å‡½æ•°
        async function connectToPhone() {
            addLog("æ­£åœ¨å‘¼å«ç›®æ ‡: " + targetPhoneId);
            
            // åˆ›å»ºè™šæ‹Ÿå ä½æµ
            const canvas = document.createElement('canvas');
            canvas.width = 1; canvas.height = 1;
            const stream = canvas.captureStream();

            const call = peer.call(targetPhoneId, stream);

            call.on('stream', (remoteStream) => {
                addLog("æˆåŠŸæ¥æ”¶åˆ°è¿œç¨‹è§†é¢‘æµï¼");
                statusBar.innerText = "ğŸŸ¢ æ­£åœ¨ç›´æ’­ä¸­";
                document.getElementById('click-tip').style.display = 'block';
                
                video.srcObject = remoteStream;
                
                // å°è¯•è‡ªåŠ¨æ’­æ”¾
                video.play().catch(err => {
                    addLog("è‡ªåŠ¨æ’­æ”¾å—é˜»ï¼Œè¯·æ‰‹åŠ¨ç‚¹å‡»é»‘è‰²åŒºåŸŸ");
                });
            });

            call.on('error', (e) => addLog("å‘¼å«é”™è¯¯: " + e.type));
        }

        // æ‰‹åŠ¨æ¿€æ´»è§†é¢‘çš„å‡½æ•°
        function forcePlay() {
            if(video.srcObject) {
                video.play();
                document.getElementById('click-tip').style.display = 'none';
                addLog("ç”¨æˆ·æ‰‹åŠ¨æ¿€æ´»æ’­æ”¾");
            }
        }

        function addLog(msg) {
            logBox.innerText += `\n[${new Date().toLocaleTimeString()}] ${msg}`;
        }

        peer.on('error', (err) => {
            if(err.type === 'peer-unavailable') addLog("ğŸ”´ é”™è¯¯ï¼šç›®æ ‡æ‰‹æœºä¸åœ¨çº¿ï¼Œè¯·åˆ·æ–°æ‰‹æœºç«¯å¹¶é‡è¯•");
        });
    </script>
</body>
</html>
